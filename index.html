<!DOCTYPE html>
<html>
    <head>
        <title>Dummy CRM</title>
        <link rel="stylesheet" type="text/css" href="css/style.css" />
        <link
            rel="stylesheet"
            type="text/css"
            href="//fonts.googleapis.com/css?family=Open+Sans"
        />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <script type="text/javascript">
            window.onload = function () {
                const dial = document.getElementById("dial-number");

                // get the window object of the Flex iframe
                const flexRef = document.getElementById("flex").contentWindow;
                // use postMessage to send the phone number to the Flex iframe
                function sendMessage(event) {
                    event.preventDefault();
                    const number = event.target.innerHTML.replaceAll(" ", "");
                    console.log(number);
                    flexRef.postMessage(number, "https://flex.twilio.com/");
                }

                dial.addEventListener("click", sendMessage);
            };
        </script>
    </head>

    <body>
        <header>
            <div>Dummy CRM</div>
        </header>
        <main>
            <div class="row">
                <div class="column">
                    <div>
                        <h2>Embedded Flex</h2>
                        <p>Flex is integrated into the CRM through an iframe</p>
                    </div>
                    <div class="iframe-wrapper">
                        <iframe
                            id="flex"
                            src="https://flex.twilio.com/"
                            class="frame"
                        ></iframe>
                    </div>
                </div>
                <div class="column crm">
                    <div>
                        <h2>CRM</h2>
                        <p>This panel can communicate with Flex</p>
                    </div>
                    <div>
                        <div>
                            <p>
                                Lorem ipsum, dolor sit amet consectetur
                                adipisicing elit. Enim, quos. Officiis sunt quia
                                alias ab impedit qui, culpa fugiat ipsam in
                                illum eaque debitis repellat veniam facere
                                praesentium vero velit rerum deserunt quibusdam
                                molestiae cum.
                                <a id="dial-number" href="tel:+380681876382"
                                    >+38 068 187 63 82</a
                                >
                                Officiis, corrupti! Optio, in magni ducimus
                                delectus asperiores dolore voluptates minus ut,
                                eos voluptatem quas sequi, sint ipsa? Animi illo
                                aut nam optio labore vel alias beatae ullam,
                                eius minima saepe laboriosam quis sapiente
                                voluptatibus nostrum, asperiores blanditiis
                                aspernatur velit itaque sint consequuntur esse
                                doloremque provident? Obcaecati asperiores cum
                                numquam delectus molestias mollitia laborum quis
                                tempore dolorum doloremque ducimus voluptatum,
                                fuga, accusamus non? Eos asperiores ratione fuga
                                quas commodi ducimus expedita, consectetur,
                                similique, veniam totam dolores ab atque minus?
                                Assumenda nam sint obcaecati soluta temporibus.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </body>
</html>
